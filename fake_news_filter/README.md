# Фильтр желтушных новостей

Фильтр определяет индекс желтушности на основе синтаксического анализа.
Анализ строится по соответствию текста статьи словарю "заряженных" слов. Словарь определяется в файле core/charged_words.txt

______________

Пока поддерживается только один новостной сайт - [ИНОСМИ.РУ](https://inosmi.ru/). Для него разработан специальный адаптер, умеющий выделять текст статьи на фоне остальной HTML разметки. Для других новостных сайтов потребуются новые адаптеры, все они будут находиться в каталоге `adapters`. Туда же помещен код для сайта ИНОСМИ.РУ: `adapters/inosmi_ru.py`.

В перспективе можно создать универсальный адаптер, подходящий для всех сайтов, но его разработка будет сложной и потребует дополнительных времени и сил.

# Как установить

Вам понадобится Python версии 3.7 или старше. Для установки пакетов рекомендуется создать виртуальное окружение.

Первым шагом установите пакеты:

```shell
pip install -r requirements.txt
```

# Как запустить
Скрипт находится в файле analyze.py
Анализ выдаёт индекс желтушности, а также выдаёт различные ошибки в соответствии с переданной ссылкой (FETCH_ERROR, PARSING_ERROR, TIMEOUT)

```shell
python analyze.py
```

Также разработан endpoint на web-сервер, который позволяет производить анализ, используя браузер

```shell
python server.py
```

Веб сервер ожидает передачу в параметр "urls" список ссылок через запятую на статьи [ИНОСМИ.РУ](https://inosmi.ru/)

Пример:
```djangourlpath
http://0.0.0.0:8080/?urls=http://example.com,https://inosmi.ru/20190629/245382801.html
```

```json
[
  {
    "url": "http://example.com",
    "status": "PARSING_ERROR",
    "rating": null,
    "words_count": null
  },
  {
    "url": "https://inosmi.ru/20190629/245382801.html",
    "status": "OK",
    "rating": 0.85,
    "words_count": 355
  }
]
```


# Как запустить тесты

Для тестирования используется [pytest](https://docs.pytest.org/en/latest/), тестами покрыты фрагменты кода сложные в отладке: text_tools.py, процесс анализа статей, возникающие ошибки и адаптеры.
Команда для запуска тестов:

```shell
python -m pytest core/tests.py
```
